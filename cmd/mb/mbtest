#!/bin/zsh
# Exit if an error occurs
set -e
DIR=~/code/m/cmd/mb/theme-test
rm -rf $DIR
mb new site $DIR
INDEX=$DIR/index.md
LINKSECTION=$DIR/links.tmp
THEMELIST=$DIR/themelist.tmp

# Create an array of filenames
declare -a themes=(
  'w'
	'wide'
	'pillar'
  'tradesman'
	)

# Create an array of variations
declare -a sidebars=(
  'left'
  'right'
  'no'
  )

# Array of modes
declare -a modes=(
  'dark'
  'light'
)

# Loop through the array
for theme in "${themes[@]}";
do
  echo "<a name=\"${theme}\"></a> " >> $LINKSECTION
  #echo "### Theme: ${theme}" >> $LINKSECTION
  echo "<br />**${theme}** " >> $LINKSECTION
  echo "[left sidebar](theme-${theme}-left-light.html) ([dark](theme-${theme}-left-dark.html)) [right sidebar](theme-${theme}-right-light.html) ([dark version](theme-${theme}-right-dark.html)) and [no sidebar](theme-${theme}-no-light.html) ([dark](theme-${theme}-no-dark.html)) " >> $LINKSECTION
  echo "[${theme}](#${theme}) " >> $THEMELIST

  for sidebar in "${sidebars[@]}";
  do
    for mode in "${modes[@]}";
    do
      FILENAME=theme-${theme}-${sidebar}-${mode}
      echo ${FILENAME}.md
cat <<-EOM > $DIR/$FILENAME.md
---
Theme: ${theme}
Sidebar: ${sidebar}
Mode: ${mode}
---
# Auto-generated test for ${theme} theme

Here's what we know about the test.
* Theme is **${theme}**. According to frontmatter it's **{{ .Page.FrontMatter.Theme }}**
* Sidebar **${sidebar}**. According to frontmatter it's **{{ .Page.FrontMatter.Sidebar }}** 
* Mode should be **${mode}**

**Note**

* **Resize this** to check for responsive versions
* Check in all browsers

#### Code example
````
print "hello, world."
````

[Home](./index.html)

EOM

#LINK="[${sidebar} sidebar, ${mode} mode](${FILENAME}.html)\n"
#echo $LINK >> $LINKSECTION

    # A single variation has been generated
    done
    
  done
# All variations on one theme have been generated
  echo "[Home](./index.html)" >> $LINKSECTION

# All test files have been generated
done
cat $THEMELIST >> $INDEX
cat $LINKSECTION >> $INDEX
mb build $DIR
open $DIR/.mb/pub/index.html

